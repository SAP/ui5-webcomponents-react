import { DocsHeader } from '@docs/DocsHeader';
import { Footer } from '@docs/Footer';
import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs';
import { Button, Menu, MenuItem } from '../';
import { useEffect, useRef } from 'react';
import { isChromatic } from '../../../../../.storybook/utils';

<Meta
  title="Modals & Popovers / Menu"
  component={Menu}
  subcomponents={{ MenuItem }}
  argTypes={{
    children: { control: { disable: true } }
  }}
  parameters={{
    chromatic: { delay: 1000 }
  }}
/>

<DocsHeader since="0.23.0" />

<br />

## Example

<Canvas>
  <Story name="Default">
    {(args) => {
      const ref = useRef();
      const btnRef = useRef(null);
      useEffect(() => {
        if (isChromatic) {
          ref.current.showAt(btnRef.current);
        }
      }, []);
      return (
        <>
          <Button
            ref={btnRef}
            onClick={(e) => {
              ref.current.showAt(e.target);
            }}
          >
            Show Menu
          </Button>
          <Menu {...args} ref={ref}>
            <MenuItem text="New File" icon="add-document"></MenuItem>
            <MenuItem text="New Folder" icon="add-folder" disabled></MenuItem>
            <MenuItem text="Open" icon="open-folder" startsSection></MenuItem>
            <MenuItem text="Close"></MenuItem>
            <MenuItem text="Preferences" icon="action-settings" startsSection></MenuItem>
            <MenuItem text="Exit" icon="journey-arrive"></MenuItem>
          </Menu>
        </>
      );
    }}
  </Story>
</Canvas>

## Properties

<ArgsTable story="." />

## Methods

This component exposes public methods. You can invoke them directly on the instance of the component, e.g. by using React Refs.

| Name       | Parameters                                                                                                                                                   | Description                             |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------- |
| **close**  | &mdash;                                                                                                                                                      | Closes the Menu.                        |
| **showAt** | <dl><dt className="methodText">**opener**</dt><dd className="methodText">the element that the popover is shown at</dd><dd><code>HTMLElement</code></dd></dl> | Shows the Menu near the opener element. |

## Usage

`Menu` contains `MenuItem` components. An arbitrary hierarchy structure can be represented by recursively nesting menu items.

## Keyboard Handling

The `Menu` provides advanced keyboard handling. The user can use the following keyboard shortcuts in order to navigate trough the tree:

- `Arrow Up` / `Arrow Down` - Navigates up and down the menu items that are currently visible.
- `Arrow Right`, `Space` or `Enter` - Opens a sub-menu if there are menu items nested in the currently clicked menu item.
- `Arrow Left` or `Escape` - Closes the currently opened sub-menu.

Note: if the text direction is set to Right-to-left (RTL), `Arrow Right` and `Arrow Left` functionality is swapped.

<Footer />
