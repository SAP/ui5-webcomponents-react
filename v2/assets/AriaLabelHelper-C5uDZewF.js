const o=new WeakMap,r=new WeakMap,m={attributes:!0,childList:!0,characterData:!0,subtree:!0},g=t=>{const e=t;return e.accessibleNameRef?k(t):e.accessibleName?e.accessibleName:void 0},k=t=>{var s;const e=((s=t.accessibleNameRef)==null?void 0:s.split(" "))??[],a=t.getRootNode();let c="";return e.forEach((l,h)=>{const n=a.querySelector(`[id='${l}']`),b=`${n&&n.textContent?n.textContent:""}`;b&&(c+=b,h<e.length-1&&(c+=" "))}),c},d=t=>{var a;const e=new Set;return f(t).forEach(c=>{e.add(c)}),(((a=t.accessibleNameRef)==null?void 0:a.split(" "))??[]).forEach(c=>{const s=v(t,c);s&&e.add(s)}),Array.from(e)},f=t=>{const e=t.getRootNode().querySelectorAll(`[for="${t.id}"]`);return Array.from(e)},v=(t,e)=>t.getRootNode().querySelector(`[id='${e}']`),p=t=>{const e=[];if(f(t).forEach(a=>{const c=a.textContent;c&&e.push(c)}),e.length)return e.join(" ")},E=t=>e=>{if(!(e&&e.type==="property"&&e.name==="accessibleNameRef"))return;const a=r.get(t);if(!a)return;const c=a.observedElements,s=d(t);c.forEach(l=>{s.includes(l)||i(a,l)}),s.forEach(l=>{c.includes(l)||(u(a,l),a.observedElements.push(l))}),a==null||a.callback()},N=(t,e)=>{if(r.has(t))return;const a=d(t),c=E(t),s={host:t,observedElements:a,callback:e,invalidationCallback:c};r.set(t,s),t.attachInvalidate(c),a.forEach(l=>{u(s,l)}),e()},u=(t,e)=>{let a=o.get(e);if(!a){a={observer:null,callbacks:[]};const c=new MutationObserver(()=>{a.callbacks.forEach(l=>{l()});const s=document.getElementById(e.id);t.host.id===e.getAttribute("for")||s||i(t,e)});a.observer=c,c.observe(e,m),o.set(e,a)}a.callbacks.includes(t.callback)||a.callbacks.push(t.callback)},i=(t,e)=>{var c;const a=o.get(e);a&&(a.callbacks=a.callbacks.filter(s=>s!==t.callback),a.callbacks.length||((c=a.observer)==null||c.disconnect(),o.delete(e))),t.observedElements=t.observedElements.filter(s=>s!==e)},y=t=>{const e=r.get(t);e&&([...e.observedElements].forEach(a=>{i(e,a)}),t.detachInvalidate(e.invalidationCallback),r.delete(t))};export{N as A,p as M,y as T,k as m,g as v};
