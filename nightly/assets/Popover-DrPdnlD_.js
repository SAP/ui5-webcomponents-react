import{j as T,F as I,h as B,p as A,d as W,s as f,m as L,E as V,v as O,V as G}from"./jsx-runtime-xa789Fx-.js";import{d as M}from"./slot-_4yKMUwC.js";import{a as S,d as R,e as F,g as D,f as $,b as x,c as j,i as U,m as P}from"./PopupsCommon.css-D_uQUn1t.js";import{a as X}from"./getEffectiveScrollbarStyle-zkSO3ShF.js";import{t as Y}from"./getActiveElement-kltGt_DR.js";import{a as q}from"./Title-BTb5jHlz.js";import{d as K}from"./parameters-bundle.css-D0uTR4GL.js";function Z(){return S.call(this,{beforeContent:J,afterContent:Q})}function J(){return B(I,{children:[T("span",{class:"ui5-popover-arrow",style:this.styles.arrow}),this._displayHeader&&T("header",{class:"ui5-popup-header-root",id:"ui5-popup-header",part:"header",children:this.header.length?T("slot",{name:"header"}):T(q,{level:"H1",class:"ui5-popup-header-text",children:this.headerText})})]})}function Q(){return T(I,{children:this._displayFooter&&!!this.footer.length&&T("footer",{class:"ui5-popup-footer-root",part:"footer",children:T("slot",{name:"footer"})})})}const z={toAttribute(r){return r instanceof HTMLElement?null:r},fromAttribute(r){return r}};var l;(function(r){r.Start="Start",r.End="End",r.Top="Top",r.Bottom="Bottom"})(l||(l={}));var v;(function(r){r.Center="Center",r.Top="Top",r.Bottom="Bottom",r.Stretch="Stretch"})(v||(v={}));var u;(function(r){r.Center="Center",r.Start="Start",r.End="End",r.Stretch="Stretch"})(u||(u={}));const tt=r=>r.parentElement?r.parentElement:r.parentNode.host;let C;const et=300,d=[],E=()=>{d.forEach(r=>{r.instance.reposition()})},ot=()=>{let r=Y();r.tagName==="IFRAME"&&dt().reverse().forEach(t=>{const e=t.instance,o=e.getOpenerHTMLElement(e.opener);for(;r;){if(r===o)return;r=tt(r)}e.closePopup(!1,!1,!0)})},rt=()=>{C=setInterval(()=>{E(),ot()},et)},it=()=>{clearInterval(C)},nt=()=>{document.addEventListener("scroll",E,{capture:!0})},st=()=>{document.removeEventListener("scroll",E,{capture:!0})},at=r=>{r&&r.shadowRoot.addEventListener("scroll",E,{capture:!0})},lt=r=>{r&&r.shadowRoot.removeEventListener("scroll",E,{capture:!0})},ht=()=>{document.addEventListener("mousedown",H,{capture:!0})},pt=()=>{document.removeEventListener("mousedown",H,{capture:!0})},H=r=>{const t=D();if(!(t.length===0||!_t(t[t.length-1].instance)))for(let o=t.length-1;o!==-1;o--){const i=t[o].instance;if(i.isModal||i.isOpenerClicked(r))return;if($(r,i.getBoundingClientRect()))break;i.closePopup()}},ct=r=>{const t=mt(r);R(r,t),d.push({instance:r,parentPopovers:t}),at(r),d.length===1&&(nt(),ht(),rt())},ut=r=>{const t=[r];for(let e=0;e<d.length;e++){const o=d[e].parentPopovers.indexOf(r);d[e].parentPopovers.length>0&&o>-1&&t.push(d[e].instance)}for(let e=t.length-1;e>=0;e--)for(let o=0;o<d.length;o++){let i=-1;t[e]===d[o].instance&&(i=o),i>=0&&(F(d[i].instance),lt(d[i].instance),d.splice(i,1)[0].instance.closePopup(!1,!0))}d.length||(st(),pt(),it())},dt=()=>d,mt=r=>{let t=r.parentNode;const e=[];for(;t&&t.parentNode;){for(let o=0;o<d.length;o++)t===d[o].instance&&e.push(t);t=t.parentNode}return e};A("@ui5/webcomponents-theming","sap_horizon",async()=>W);A("@ui5/webcomponents","sap_horizon",async()=>K);const ft=`:host{box-shadow:var(--_ui5-v2-12-0_popover_box_shadow);background-color:var(--_ui5-v2-12-0_popover_background);max-width:calc(100vw - (100vw - 100%) - 2 * var(--_ui5-v2-12-0_popup_viewport_margin))}:host([hide-arrow]){box-shadow:var(--_ui5-v2-12-0_popover_no_arrow_box_shadow)}:host([actual-placement="Bottom"]) .ui5-popover-arrow{left:calc(50% - .5625rem);top:-.5rem;height:.5rem}:host([actual-placement="Bottom"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-12-0_popover_upward_arrow_margin)}:host([actual-placement="Start"]) .ui5-popover-arrow{top:calc(50% - .5625rem);right:-.5625rem;width:.5625rem}:host([actual-placement="Start"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-12-0_popover_right_arrow_margin)}:host([actual-placement="Top"]) .ui5-popover-arrow{left:calc(50% - .5625rem);height:.5625rem;top:100%}:host([actual-placement="Top"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-12-0_popover_downward_arrow_margin)}:host(:not([actual-placement])) .ui5-popover-arrow,:host([actual-placement="End"]) .ui5-popover-arrow{left:-.5625rem;top:calc(50% - .5625rem);width:.5625rem;height:1rem}:host(:not([actual-placement])) .ui5-popover-arrow:after,:host([actual-placement="End"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-12-0_popover_left_arrow_margin)}:host([hide-arrow]) .ui5-popover-arrow{display:none}.ui5-popover-root{min-width:6.25rem}.ui5-popover-arrow{pointer-events:none;display:block;width:1rem;height:1rem;position:absolute;overflow:hidden}.ui5-popover-arrow:after{content:"";display:block;width:.7rem;height:.7rem;background-color:var(--_ui5-v2-12-0_popover_background);box-shadow:var(--_ui5-v2-12-0_popover_box_shadow);transform:rotate(-45deg)}:host([modal])::backdrop{background-color:var(--_ui5-v2-12-0_popup_block_layer_background);opacity:var(--_ui5-v2-12-0_popup_block_layer_opacity)}:host([modal]) .ui5-block-layer{display:block}
`;var m=function(r,t,e,o){var i=arguments.length,n=i<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,e):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,t,e,o);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(n=(i<3?a(n):i>3?a(t,e,n):a(t,e))||n);return i>3&&n&&Object.defineProperty(t,e,n),n},h;const y=8;let p=h=class extends x{static get VIEWPORT_MARGIN(){return 10}constructor(){super(),this.placement="End",this.horizontalAlign="Center",this.verticalAlign="Center",this.modal=!1,this.hideArrow=!1,this.allowTargetOverlap=!1,this.arrowTranslateX=0,this.arrowTranslateY=0,this.actualPlacement="End"}set opener(t){this._opener!==t&&(this._opener=t,t&&this.open&&this.openPopup())}get opener(){return this._opener}async openPopup(){if(this._opened)return;const t=this.getOpenerHTMLElement(this.opener);if(t){if(this.isOpenerOutsideViewport(t.getBoundingClientRect())){await V(),this.open=!1,this.fireDecoratorEvent("close");return}this._openerRect=t.getBoundingClientRect(),await super.openPopup()}}isOpenerClicked(t){const e=t.target,o=this.getOpenerHTMLElement(this.opener);return o?e===o||this._isUI5AbstractElement(e)&&e.getFocusDomRef()===o?!0:t.composedPath().indexOf(o)>-1:!1}_addOpenedPopup(){ct(this)}_removeOpenedPopup(){ut(this)}getOpenerHTMLElement(t){if(t===void 0)return t;if(t instanceof HTMLElement)return this._isUI5AbstractElement(t)?t.getFocusDomRef():t;let e=this.getRootNode();e===this&&(e=document);let o=e.getElementById(t);return e instanceof ShadowRoot&&!o&&(o=document.getElementById(t)),o&&(this._isUI5AbstractElement(o)?o.getFocusDomRef():o)}shouldCloseDueToOverflow(t,e){const i={Start:e.right,End:e.left,Top:e.top,Bottom:e.bottom},n=this.getOpenerHTMLElement(this.opener),a=U(n);let s=!1,c=!1;if(a instanceof h){const _=a.getBoundingClientRect();s=e.top>_.top+_.height,c=e.top+e.height<_.top}return i[t]<0||i[t]+32>a.innerHeight||s||c}shouldCloseDueToNoOpener(t){return t.top===0&&t.bottom===0&&t.left===0&&t.right===0}isOpenerOutsideViewport(t){return t.bottom<0||t.top>window.innerHeight||t.right<0||t.left>window.innerWidth}_resize(){super._resize(),this.open&&this.reposition()}reposition(){this._show()}async _show(){super._show();const t=this.getOpenerHTMLElement(this.opener);if(t&&O(t)&&!t.getDomRef())return;this._opened||this._showOutsideViewport();const e=this.getPopoverSize();let o;if(e.width===0||e.height===0)return;if(this.open&&(this._openerRect=t.getBoundingClientRect()),this._oldPlacement&&this.shouldCloseDueToNoOpener(this._openerRect)&&this.isFocusWithin()?o=this._oldPlacement:o=this.calcPlacement(this._openerRect,e),this._preventRepositionAndClose||this.isOpenerOutsideViewport(this._openerRect))return await this._waitForDomRef(),this.closePopup();this._oldPlacement=o,this.actualPlacement=o.placement;let i=P(this._left,h.VIEWPORT_MARGIN,document.documentElement.clientWidth-e.width-h.VIEWPORT_MARGIN);this.actualPlacement===l.End&&(i=Math.max(i,this._left));let n=P(this._top,h.VIEWPORT_MARGIN,document.documentElement.clientHeight-e.height-h.VIEWPORT_MARGIN);this.actualPlacement===l.Bottom&&(n=Math.max(n,this._top)),this.arrowTranslateX=o.arrow.x,this.arrowTranslateY=o.arrow.y,n=this._adjustForIOSKeyboard(n),Object.assign(this.style,{top:`${n}px`,left:`${i}px`}),this.horizontalAlign===u.Stretch&&this._width&&(this.style.width=this._width),this.verticalAlign===v.Stretch&&this._height&&(this.style.height=this._height)}_adjustForIOSKeyboard(t){if(!G())return t;const e=Math.ceil(this.getBoundingClientRect().top);return t+(Number.parseInt(this.style.top||"0")-e)}getPopoverSize(t=!1){const e=this.getBoundingClientRect(),o=e.width;let i;const n=this.getDomRef();if(t&&n){const a=n.querySelector(".ui5-popup-header-root"),s=n.querySelector(".ui5-popup-content"),c=n.querySelector(".ui5-popup-footer-root");i=(s==null?void 0:s.scrollHeight)||0,i+=(a==null?void 0:a.scrollHeight)||0,i+=(c==null?void 0:c.scrollHeight)||0}else i=e.height;return{width:o,height:i}}_showOutsideViewport(){Object.assign(this.style,{top:"-10000px",left:"-10000px"})}_isUI5AbstractElement(t){return O(t)&&t.isUI5AbstractElement}get arrowDOM(){return this.shadowRoot.querySelector(".ui5-popover-arrow")}focusOpener(){var t;(t=this.getOpenerHTMLElement(this.opener))==null||t.focus()}calcPlacement(t,e){let o=h.VIEWPORT_MARGIN,i=0;const n=this.allowTargetOverlap,a=document.documentElement.clientWidth,s=document.documentElement.clientHeight;let c=s,_=a;const g=this.getActualPlacement(t);this._preventRepositionAndClose=this.shouldCloseDueToNoOpener(t)||this.shouldCloseDueToOverflow(g,t);const b=g===l.Top||g===l.Bottom;this.horizontalAlign===u.Stretch&&b?(e.width=t.width,this._width=`${t.width}px`):this.verticalAlign===v.Stretch&&!b&&(e.height=t.height,this._height=`${t.height}px`);const w=this.hideArrow?0:y;switch(g){case l.Top:o=this.getVerticalLeft(t,e),i=Math.max(t.top-e.height-w,0),n||(c=t.top-w);break;case l.Bottom:o=this.getVerticalLeft(t,e),i=t.bottom+w,n?i=Math.max(Math.min(i,s-e.height),0):c=s-t.bottom-w;break;case l.Start:o=Math.max(t.left-e.width-w,0),i=this.getHorizontalTop(t,e),n||(_=t.left-w);break;case l.End:o=t.left+t.width+w,i=this.getHorizontalTop(t,e),n?o=Math.max(Math.min(o,a-e.width),0):_=a-t.right-w;break}b?e.width>a||o<h.VIEWPORT_MARGIN?o=h.VIEWPORT_MARGIN:o+e.width>a-h.VIEWPORT_MARGIN&&(o=a-h.VIEWPORT_MARGIN-e.width):e.height>s||i<h.VIEWPORT_MARGIN?i=h.VIEWPORT_MARGIN:i+e.height>s-h.VIEWPORT_MARGIN&&(i=s-h.VIEWPORT_MARGIN-e.height),this._maxHeight=Math.round(c-h.VIEWPORT_MARGIN),this._maxWidth=Math.round(_-h.VIEWPORT_MARGIN),(this._left===void 0||Math.abs(this._left-o)>1.5)&&(this._left=Math.round(o)),(this._top===void 0||Math.abs(this._top-i)>1.5)&&(this._top=Math.round(i));const N=Number.parseInt(window.getComputedStyle(this).getPropertyValue("border-radius")),k=this.getArrowPosition(t,e,o,i,b,N);return this._left+=this.getRTLCorrectionLeft(),{arrow:k,top:this._top,left:this._left,placement:g}}getRTLCorrectionLeft(){return parseFloat(window.getComputedStyle(this).left)-this.getBoundingClientRect().left}getArrowPosition(t,e,o,i,n,a){const s=this._actualHorizontalAlign;let c=s===u.Center||s===u.Stretch;s===u.End&&o<=t.left&&(c=!0),s===u.Start&&o+e.width>=t.left+t.width&&(c=!0);let _=0;n&&c&&(_=t.left+t.width/2-o-e.width/2);let g=0;n||(g=t.top+t.height/2-i-e.height/2);const b=e.height/2-a-y/2-2;g=P(g,-b,b);const w=e.width/2-a-y/2-2;return _=P(_,-w,w),{x:Math.round(_),y:Math.round(g)}}fallbackPlacement(t,e,o,i){if(o.left>i.width)return l.Start;if(t-o.right>o.left)return l.End;if(e-o.bottom>i.height)return l.Bottom;if(e-o.bottom<o.top)return l.Top}getActualPlacement(t){const e=this.placement;let o=e;const i=e===l.Top||e===l.Bottom,n=this.getPopoverSize(!this.allowTargetOverlap),a=document.documentElement.clientWidth;let s=document.documentElement.clientHeight,c=n.height;switch(i&&(c+=this.hideArrow?0:y,s-=h.VIEWPORT_MARGIN),e){case l.Top:t.top<c&&t.top<s-t.bottom&&(o=l.Bottom);break;case l.Bottom:s-t.bottom<c&&s-t.bottom<t.top&&(o=l.Top);break;case l.Start:t.left<n.width&&(o=this.fallbackPlacement(a,s,t,n)||e);break;case l.End:a-t.right<n.width&&(o=this.fallbackPlacement(a,s,t,n)||e);break}return o}getVerticalLeft(t,e){const o=this._actualHorizontalAlign;let i=h.VIEWPORT_MARGIN;switch(o){case u.Center:case u.Stretch:i=t.left-(e.width-t.width)/2;break;case u.Start:i=t.left;break;case u.End:i=t.right-e.width;break}return i}getHorizontalTop(t,e){let o=0;switch(this.verticalAlign){case v.Center:case v.Stretch:o=t.top-(e.height-t.height)/2;break;case v.Top:o=t.top;break;case v.Bottom:o=t.bottom-e.height;break}return o}get isModal(){return this.modal}get _ariaLabelledBy(){if(!this._ariaLabel&&this._displayHeader)return"ui5-popup-header"}get styles(){return{...super.styles,root:{"max-height":this._maxHeight?`${this._maxHeight}px`:"","max-width":this._maxWidth?`${this._maxWidth}px`:""},arrow:{transform:`translate(${this.arrowTranslateX}px, ${this.arrowTranslateY}px)`}}}get classes(){const t=super.classes;return t.root["ui5-popover-root"]=!0,t}get _displayHeader(){return!!(this.header.length||this.headerText)}get _displayFooter(){return!0}get _actualHorizontalAlign(){if(this.effectiveDir==="rtl"){if(this.horizontalAlign===u.Start)return u.End;if(this.horizontalAlign===u.End)return u.Start}return this.horizontalAlign}};m([f()],p.prototype,"headerText",void 0);m([f()],p.prototype,"placement",void 0);m([f()],p.prototype,"horizontalAlign",void 0);m([f()],p.prototype,"verticalAlign",void 0);m([f({type:Boolean})],p.prototype,"modal",void 0);m([f({type:Boolean})],p.prototype,"hideArrow",void 0);m([f({type:Boolean})],p.prototype,"allowTargetOverlap",void 0);m([f({type:Number,noAttribute:!0})],p.prototype,"arrowTranslateX",void 0);m([f({type:Number,noAttribute:!0})],p.prototype,"arrowTranslateY",void 0);m([f()],p.prototype,"actualPlacement",void 0);m([f({type:Number,noAttribute:!0})],p.prototype,"_maxHeight",void 0);m([f({type:Number,noAttribute:!0})],p.prototype,"_maxWidth",void 0);m([M({type:HTMLElement})],p.prototype,"header",void 0);m([M({type:HTMLElement})],p.prototype,"footer",void 0);m([f({converter:z})],p.prototype,"opener",null);p=h=m([L({tag:"ui5-popover",styles:[x.styles,j,ft,X()],template:Z})],p);const _t=r=>"opener"in r;p.define();const Ot=p;export{l as P,v as a,u as b,Z as c,Ot as d,z as e,tt as f};
