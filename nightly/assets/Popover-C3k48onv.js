import{h as b,f as C,s as D,a as m,m as F,p as G}from"./withWebComponent-Dj0CMfaz.js";import{d as B}from"./slot-_4yKMUwC.js";import{a4 as S}from"./Keys-F_3Gvx0K.js";import{b as j,c as X,g as Y,f as R,a as H,s as q,i as K,m as O}from"./PopupsCommon.css-CL-yqmiO.js";import{t as U}from"./getActiveElement-kltGt_DR.js";import{s as E}from"./style-map-CpZMqJvf.js";import{o as $}from"./class-map-DwAhupCS.js";import{l as P}from"./if-defined-B8mU3KX1.js";import{s as Z}from"./BrowserScrollbar.css-C7k9hgHd.js";import{s as J}from"./parameters-bundle.css-BFbT_feV.js";const Q=o=>{const t=getComputedStyle(o);return["size","inline-size"].indexOf(t.containerType)>-1||["transform","perspective"].indexOf(t.willChange)>-1||["layout","paint","strict","content"].indexOf(t.contain)>-1||t.transform&&t.transform!=="none"||t.perspective&&t.perspective!=="none"||t.backdropFilter&&t.backdropFilter!=="none"},I=o=>o.parentElement?o.parentNode:o.parentNode.host,z={toAttribute(o){return o instanceof HTMLElement?null:o},fromAttribute(o){return o}};var k;(function(o){o.Start="Start",o.End="End",o.Top="Top",o.Bottom="Bottom"})(k||(k={}));const h=k;var A;(function(o){o.Center="Center",o.Top="Top",o.Bottom="Bottom",o.Stretch="Stretch"})(A||(A={}));const y=A;var M;(function(o){o.Center="Center",o.Start="Start",o.End="End",o.Stretch="Stretch"})(M||(M={}));const u=M;let N;const tt=300,c=[],T=()=>{c.forEach(o=>{o.instance.reposition()})},et=()=>{U().tagName==="IFRAME"&&dt().reverse().forEach(o=>o.instance.closePopup(!1,!1,!0))},ot=()=>{N=setInterval(()=>{T(),et()},tt)},rt=()=>{clearInterval(N)},nt=()=>{document.addEventListener("scroll",T,{capture:!0})},it=()=>{document.removeEventListener("scroll",T,{capture:!0})},st=o=>{o&&o.shadowRoot.addEventListener("scroll",T,{capture:!0})},at=o=>{o&&o.shadowRoot.removeEventListener("scroll",T,{capture:!0})},lt=()=>{document.addEventListener("mousedown",L)},ht=()=>{document.removeEventListener("mousedown",L)},L=o=>{const t=Y();if(!(t.length===0||!W(t[t.length-1].instance)))for(let r=t.length-1;r!==-1;r--){const n=t[r].instance;if(n.isModal||n.isOpenerClicked(o))return;if(R(o,n.getBoundingClientRect()))break;n.closePopup()}},pt=o=>{const t=ut(o);j(o,t),c.push({instance:o,parentPopovers:t}),st(o),c.length===1&&(nt(),lt(),ot())},ct=o=>{const t=[o];for(let e=0;e<c.length;e++){const r=c[e].parentPopovers.indexOf(o);c[e].parentPopovers.length>0&&r>-1&&t.push(c[e].instance)}for(let e=t.length-1;e>=0;e--)for(let r=0;r<c.length;r++){let n=-1;t[e]===c[r].instance&&(n=r),n>=0&&(X(c[n].instance),at(c[n].instance),c.splice(n,1)[0].instance.closePopup(!1,!0))}c.length||(it(),ht(),rt())},dt=()=>c,ut=o=>{let t=o.parentNode;const e=[];for(;t&&t.parentNode;){for(let r=0;r<c.length;r++)t===c[r].instance&&e.push(t);t=t.parentNode}return e};function mt(o,t,e){return b`<div class="ui5-block-layer" @keydown="${this._preventBlockLayerFocus}" @mousedown="${this._preventBlockLayerFocus}"></div><section root-element style="${E(this.styles.root)}" class="${$(this.classes.root)}" role="${P(this._role)}" tabindex="-1" aria-modal="${P(this._ariaModal)}" aria-label="${P(this._ariaLabel)}" aria-labelledby="${P(this._ariaLabelledBy)}" @keydown=${this._onkeydown} @focusout=${this._onfocusout} @mouseup=${this._onmouseup} @mousedown=${this._onmousedown}><span class="first-fe" data-ui5-focus-trap tabindex="0" @focusin=${this.forwardToLast}></span><span class="ui5-popover-arrow" style="${E(this.styles.arrow)}"></span>${this._displayHeader?ft.call(this,o,t,e):void 0}<div style="${E(this.styles.content)}" class="${$(this.classes.content)}"  @scroll="${this._scroll}" part="content"><slot></slot></div>${this._displayFooter?gt.call(this,o,t,e):void 0}<span class="last-fe" data-ui5-focus-trap tabindex="0" @focusin=${this.forwardToFirst}></span></section> `}function ft(o,t,e){return b`<header class="ui5-popup-header-root" id="ui5-popup-header" part="header">${this.header.length?wt.call(this,o,t,e):_t.call(this,o,t,e)}</header>`}function wt(o,t,e){return b`<slot name="header"></slot>`}function _t(o,t,e){return b`<h1 class="ui5-popup-header-text">${P(this.headerText)}</h1>`}function gt(o,t,e){return b`${this.footer.length?vt.call(this,o,t,e):void 0}`}function vt(o,t,e){return b`<footer class="ui5-popup-footer-root" part="footer"><slot name="footer"></slot></footer>`}C("@ui5/webcomponents-theming","sap_horizon",async()=>D);C("@ui5/webcomponents","sap_horizon",async()=>J);const bt={packageName:"@ui5/webcomponents",fileName:"themes/Popover.css.ts",content:`:host{box-shadow:var(--_ui5-v2-0-1_popover_box_shadow);background-color:var(--_ui5-v2-0-1_popover_background);max-width:calc(100vw - (100vw - 100%) - 2 * var(--_ui5-v2-0-1_popup_viewport_margin))}:host([hide-arrow]){box-shadow:var(--_ui5-v2-0-1_popover_no_arrow_box_shadow)}:host([opened][actual-placement="Top"]){margin-top:var(--_ui5-v2-0-1-popover-margin-bottom)}:host([opened][actual-placement="Bottom"]){margin-top:var(--_ui5-v2-0-1-popover-margin-top)}:host([actual-placement="Bottom"]) .ui5-popover-arrow{left:calc(50% - .5625rem);top:-.5rem;height:.5625rem}:host([actual-placement="Bottom"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-0-1_popover_upward_arrow_margin)}:host([actual-placement="Start"]) .ui5-popover-arrow{top:calc(50% - .5625rem);right:-.5625rem;width:.5625rem}:host([actual-placement="Start"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-0-1_popover_right_arrow_margin)}:host([actual-placement="Top"]) .ui5-popover-arrow{left:calc(50% - .5625rem);height:.5625rem;top:100%}:host([actual-placement="Top"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-0-1_popover_downward_arrow_margin)}:host(:not([actual-placement])) .ui5-popover-arrow,:host([actual-placement="End"]) .ui5-popover-arrow{left:-.5625rem;top:calc(50% - .5625rem);width:.5625rem;height:1rem}:host(:not([actual-placement])) .ui5-popover-arrow:after,:host([actual-placement="End"]) .ui5-popover-arrow:after{margin:var(--_ui5-v2-0-1_popover_left_arrow_margin)}:host([hide-arrow]) .ui5-popover-arrow{display:none}.ui5-popover-root{min-width:6.25rem}.ui5-popover-arrow{pointer-events:none;display:block;width:1rem;height:1rem;position:absolute;overflow:hidden}.ui5-popover-arrow:after{content:"";display:block;width:.7rem;height:.7rem;background-color:var(--_ui5-v2-0-1_popover_background);box-shadow:var(--_ui5-v2-0-1_popover_box_shadow);transform:rotate(-45deg)}:host([modal])::backdrop{background-color:var(--_ui5-v2-0-1_popup_block_layer_background)}:host([modal]) .ui5-block-layer{display:block}
`};var p=function(o,t,e,r){var n=arguments.length,s=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,t,e,r);else for(var l=o.length-1;l>=0;l--)(i=o[l])&&(s=(n<3?i(s):n>3?i(t,e,s):i(t,e))||s);return n>3&&s&&Object.defineProperty(t,e,s),s},d;const x=8;let a=d=class extends H{static get VIEWPORT_MARGIN(){return 10}constructor(){super(),this.placement="End",this.horizontalAlign="Center",this.verticalAlign="Center",this.modal=!1,this.hideArrow=!1,this.allowTargetOverlap=!1,this.disableScrolling=!1,this.arrowTranslateX=0,this.arrowTranslateY=0,this.actualPlacement="End"}set opener(t){this._opener!==t&&(this._opener=t,t&&this.open&&this.openPopup())}get opener(){return this._opener}async openPopup(){if(this._opened)return;const t=this.getOpenerHTMLElement(this.opener);if(!t){console.warn("Valid opener id is required. It must be defined before opening the popover.");return}if(this.isOpenerOutsideViewport(t.getBoundingClientRect())){await G(),this.open=!1,this.fireEvent("close",{},!1,!1);return}this._openerRect=t.getBoundingClientRect(),await super.openPopup()}isOpenerClicked(t){const e=t.target;if(e===this._opener)return!0;const r=e;return r.getFocusDomRef&&r.getFocusDomRef()===this._opener?!0:t.composedPath().indexOf(this._opener)>-1}_addOpenedPopup(){pt(this)}_removeOpenedPopup(){ct(this)}getOpenerHTMLElement(t){if(t===void 0||t instanceof HTMLElement)return t;const e=this.getRootNode();return e instanceof Document?e.getElementById(t):document.getElementById(t)}shouldCloseDueToOverflow(t,e){const n={Start:e.right,End:e.left,Top:e.top,Bottom:e.bottom},s=this.getOpenerHTMLElement(this.opener),i=K(s);let l=!1,_=!1;if(i instanceof d){const f=i.contentDOM.getBoundingClientRect();l=e.top>f.top+f.height,_=e.top+e.height<f.top}return n[t]<0||n[t]+32>i.innerHeight||l||_}shouldCloseDueToNoOpener(t){return t.top===0&&t.bottom===0&&t.left===0&&t.right===0}isOpenerOutsideViewport(t){return t.bottom<0||t.top>window.innerHeight||t.right<0||t.left>window.innerWidth}_resize(){super._resize(),this.open&&this.reposition()}reposition(){this._show()}async _show(){super._show(),this._opened||this._showOutsideViewport();const t=this.getPopoverSize();let e;if(t.width===0||t.height===0)return;if(this.open&&(this._openerRect=this.getOpenerHTMLElement(this.opener).getBoundingClientRect()),this.shouldCloseDueToNoOpener(this._openerRect)&&this.isFocusWithin()&&this._oldPlacement?e=this._oldPlacement:e=this.calcPlacement(this._openerRect,t),this._preventRepositionAndClose||this.isOpenerOutsideViewport(this._openerRect))return await this._waitForDomRef(),this.closePopup();this._oldPlacement=e,this.actualPlacement=e.placement;let r=O(this._left,d.VIEWPORT_MARGIN,document.documentElement.clientWidth-t.width-d.VIEWPORT_MARGIN);this.actualPlacement===h.End&&(r=Math.max(r,this._left));let n=O(this._top,d.VIEWPORT_MARGIN,document.documentElement.clientHeight-t.height-d.VIEWPORT_MARGIN);this.actualPlacement===h.Bottom&&(n=Math.max(n,this._top)),this.arrowTranslateX=e.arrow.x,this.arrowTranslateY=e.arrow.y,n=this._adjustForIOSKeyboard(n),Object.assign(this.style,{top:`${n}px`,left:`${r}px`}),this.horizontalAlign===u.Stretch&&this._width&&(this.style.width=this._width)}_adjustForIOSKeyboard(t){if(!S())return t;const e=Math.ceil(this.getBoundingClientRect().top);return t+(Number.parseInt(this.style.top||"0")-e)}_getContainingBlockClientLocation(){let t=I(this);for(;t;){if(Q(t))return t.getBoundingClientRect();t=I(t)}return{left:0,top:0}}getPopoverSize(){const t=this.getBoundingClientRect(),e=t.width,r=t.height;return{width:e,height:r}}_showOutsideViewport(){Object.assign(this.style,{top:"-10000px",left:"-10000px"})}get arrowDOM(){return this.shadowRoot.querySelector(".ui5-popover-arrow")}calcPlacement(t,e){let r=d.VIEWPORT_MARGIN,n=0;const s=this.allowTargetOverlap,i=document.documentElement.clientWidth,l=document.documentElement.clientHeight;let _=l,f=i;const g=this.getActualPlacement(t,e);this._preventRepositionAndClose=this.shouldCloseDueToNoOpener(t)||this.shouldCloseDueToOverflow(g,t);const v=g===h.Top||g===h.Bottom;this.horizontalAlign===u.Stretch&&v?(e.width=t.width,this._width=`${t.width}px`):this.verticalAlign===y.Stretch&&!v&&(e.height=t.height);const w=this.hideArrow?0:x;switch(g){case h.Top:r=this.getVerticalLeft(t,e),n=Math.max(t.top-e.height-w,0),s||(_=t.top-w);break;case h.Bottom:r=this.getVerticalLeft(t,e),n=t.bottom+w,s?n=Math.max(Math.min(n,l-e.height),0):_=l-t.bottom-w;break;case h.Start:r=Math.max(t.left-e.width-w,0),n=this.getHorizontalTop(t,e),s||(f=t.left-w);break;case h.End:r=t.left+t.width+w,n=this.getHorizontalTop(t,e),s?r=Math.max(Math.min(r,i-e.width),0):f=i-t.right-w;break}v?e.width>i||r<d.VIEWPORT_MARGIN?r=d.VIEWPORT_MARGIN:r+e.width>i-d.VIEWPORT_MARGIN&&(r=i-d.VIEWPORT_MARGIN-e.width):e.height>l||n<0?n=0:n+e.height>l&&(n-=n+e.height-l),this._maxHeight=Math.round(_-d.VIEWPORT_MARGIN),this._maxWidth=Math.round(f-d.VIEWPORT_MARGIN),(this._left===void 0||Math.abs(this._left-r)>1.5)&&(this._left=Math.round(r)),(this._top===void 0||Math.abs(this._top-n)>1.5)&&(this._top=Math.round(n));const V=Number.parseInt(window.getComputedStyle(this).getPropertyValue("border-radius"));return{arrow:this.getArrowPosition(t,e,r,n,v,V),top:this._top,left:this._left,placement:g}}getArrowPosition(t,e,r,n,s,i){const l=this._actualHorizontalAlign;let _=l===u.Center||l===u.Stretch;l===u.End&&r<=t.left&&(_=!0),l===u.Start&&r+e.width>=t.left+t.width&&(_=!0);let f=0;s&&_&&(f=t.left+t.width/2-r-e.width/2);let g=0;s||(g=t.top+t.height/2-n-e.height/2);const v=e.height/2-i-x/2;g=O(g,-v,v);const w=e.width/2-i-x/2;return f=O(f,-w,w),{x:Math.round(f),y:Math.round(g)}}fallbackPlacement(t,e,r,n){if(r.left>n.width)return h.Start;if(t-r.right>r.left)return h.End;if(e-r.bottom>n.height)return h.Bottom;if(e-r.bottom<r.top)return h.Top}getActualPlacement(t,e){const r=this.placement;let n=r;const s=document.documentElement.clientWidth,i=document.documentElement.clientHeight;switch(r){case h.Top:t.top<e.height&&t.top<i-t.bottom&&(n=h.Bottom);break;case h.Bottom:i-t.bottom<e.height&&i-t.bottom<t.top&&(n=h.Top);break;case h.Start:t.left<e.width&&(n=this.fallbackPlacement(s,i,t,e)||r);break;case h.End:s-t.right<e.width&&(n=this.fallbackPlacement(s,i,t,e)||r);break}return n}getVerticalLeft(t,e){const r=this._actualHorizontalAlign;let n=d.VIEWPORT_MARGIN;switch(r){case u.Center:case u.Stretch:n=t.left-(e.width-t.width)/2;break;case u.Start:n=t.left;break;case u.End:n=t.right-e.width;break}return n}getHorizontalTop(t,e){let r=0;switch(this.verticalAlign){case y.Center:case y.Stretch:r=t.top-(e.height-t.height)/2;break;case y.Top:r=t.top;break;case y.Bottom:r=t.bottom-e.height;break}return r}get isModal(){return this.modal}get _ariaLabelledBy(){if(!this._ariaLabel&&this._displayHeader)return"ui5-popup-header"}get styles(){return{...super.styles,root:{"max-height":this._maxHeight?`${this._maxHeight}px`:"","max-width":this._maxWidth?`${this._maxWidth}px`:""},arrow:{transform:`translate(${this.arrowTranslateX}px, ${this.arrowTranslateY}px)`}}}get classes(){const t=super.classes;return t.root["ui5-popover-root"]=!0,t}get _displayHeader(){return!!(this.header.length||this.headerText)}get _displayFooter(){return!0}get _actualHorizontalAlign(){if(this.effectiveDir==="rtl"){if(this.horizontalAlign===u.Start)return u.End;if(this.horizontalAlign===u.End)return u.Start}return this.horizontalAlign}};p([m()],a.prototype,"headerText",void 0);p([m()],a.prototype,"placement",void 0);p([m()],a.prototype,"horizontalAlign",void 0);p([m()],a.prototype,"verticalAlign",void 0);p([m({type:Boolean})],a.prototype,"modal",void 0);p([m({type:Boolean})],a.prototype,"hideArrow",void 0);p([m({type:Boolean})],a.prototype,"allowTargetOverlap",void 0);p([m({type:Boolean})],a.prototype,"disableScrolling",void 0);p([m({type:Number,noAttribute:!0})],a.prototype,"arrowTranslateX",void 0);p([m({type:Number,noAttribute:!0})],a.prototype,"arrowTranslateY",void 0);p([m()],a.prototype,"actualPlacement",void 0);p([m({type:Number,noAttribute:!0})],a.prototype,"_maxHeight",void 0);p([m({type:Number,noAttribute:!0})],a.prototype,"_maxWidth",void 0);p([B({type:HTMLElement})],a.prototype,"header",void 0);p([B({type:HTMLElement})],a.prototype,"footer",void 0);p([m({converter:z})],a.prototype,"opener",null);a=d=p([F({tag:"ui5-popover",styles:[H.styles,Z,q,bt],template:mt})],a);const W=o=>"opener"in o;a.define();const yt=a,Ht=Object.freeze(Object.defineProperty({__proto__:null,default:yt,instanceOfPopover:W},Symbol.toStringTag,{value:"Module"}));export{h as P,u as a,y as b,yt as c,Ht as d,z as e};
