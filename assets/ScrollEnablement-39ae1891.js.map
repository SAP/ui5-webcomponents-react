{"version":3,"file":"ScrollEnablement-39ae1891.js","sources":["../../node_modules/@ui5/webcomponents-base/dist/animations/scroll.js","../../node_modules/@ui5/webcomponents-base/dist/delegate/ScrollEnablement.js"],"sourcesContent":["import animate, { duration } from \"./animate.js\";\nconst scroll = (element, dx, dy) => {\n    let scrollLeft;\n    let scrollTop;\n    return animate({\n        beforeStart: () => {\n            scrollLeft = element.scrollLeft;\n            scrollTop = element.scrollTop;\n        },\n        duration,\n        element,\n        advance: progress => {\n            element.scrollLeft = scrollLeft + (progress * dx); // easing - linear\n            element.scrollTop = scrollTop + (progress * dy); // easing - linear\n        },\n    });\n};\nexport default scroll;\n//# sourceMappingURL=scroll.js.map","import { supportsTouch } from \"../Device.js\";\nimport EventProvider from \"../EventProvider.js\";\nimport scroll from \"../animations/scroll.js\";\nconst scrollEventName = \"scroll\";\nconst touchEndEventName = supportsTouch() ? \"touchend\" : \"mouseup\";\nclass ScrollEnablement extends EventProvider {\n    constructor(containerComponent) {\n        super();\n        this.supportsTouch = supportsTouch();\n        this.containerComponent = containerComponent;\n        this.mouseMove = this.ontouchmove.bind(this);\n        this.mouseUp = this.ontouchend.bind(this);\n        this.touchStart = this.ontouchstart.bind(this);\n        this.supportsTouch = supportsTouch();\n        // On Android devices touchmove is thrown one more time than neccessary (together with touchend)\n        // so we have to cache the previus coordinates in order to provide correct parameters in the\n        // event for Android\n        this.cachedValue = { dragX: 0, dragY: 0 };\n        // In components like Carousel you need to know if the user has clicked on something or swiped\n        // in order to throw the needed event or not\n        this.startX = 0;\n        this.startY = 0;\n        if (this.supportsTouch) {\n            containerComponent.addEventListener(\"touchstart\", this.touchStart, { passive: true });\n            containerComponent.addEventListener(\"touchmove\", this.mouseMove, { passive: true });\n            containerComponent.addEventListener(\"touchend\", this.mouseUp, { passive: true });\n        }\n        else {\n            containerComponent.addEventListener(\"mousedown\", this.touchStart, { passive: true });\n        }\n    }\n    set scrollContainer(container) {\n        this._container = container;\n    }\n    get scrollContainer() {\n        return this._container;\n    }\n    /**\n     * Scrolls the container to the left/top position, retrying retryCount times, if the container is not yet painted\n     *\n     * @param left\n     * @param top\n     * @param retryCount\n     * @param retryInterval\n     * @returns {Promise<void>} resolved when scrolled successfully\n     */\n    async scrollTo(left, top, retryCount = 0, retryInterval = 0) {\n        let containerPainted = this.scrollContainer.clientHeight > 0 && this.scrollContainer.clientWidth > 0;\n        /* eslint-disable no-loop-func, no-await-in-loop */\n        while (!containerPainted && retryCount > 0) {\n            await new Promise(resolve => {\n                setTimeout(() => {\n                    containerPainted = this.scrollContainer.clientHeight > 0 && this.scrollContainer.clientWidth > 0;\n                    retryCount--;\n                    resolve();\n                }, retryInterval);\n            });\n        }\n        /* eslint-disable no-loop-func, no-await-in-loop */\n        this._container.scrollLeft = left;\n        this._container.scrollTop = top;\n    }\n    move(dx, dy, disableAnimation) {\n        if (disableAnimation) {\n            this._container.scrollLeft += dx;\n            this._container.scrollTop += dy;\n            return;\n        }\n        if (this._container) {\n            return scroll(this._container, dx, dy);\n        }\n    }\n    getScrollLeft() {\n        return this._container.scrollLeft;\n    }\n    getScrollTop() {\n        return this._container.scrollTop;\n    }\n    _isTouchInside(event) {\n        let touch = null;\n        if (this.supportsTouch && event instanceof TouchEvent) {\n            touch = event.touches[0];\n        }\n        const rect = this._container.getBoundingClientRect();\n        const x = this.supportsTouch ? touch.clientX : event.x;\n        const y = this.supportsTouch ? touch.clientY : event.y;\n        return x >= rect.left && x <= rect.right\n            && y >= rect.top && y <= rect.bottom;\n    }\n    ontouchstart(event) {\n        let touch = null;\n        if (this.supportsTouch && event instanceof TouchEvent) {\n            touch = event.touches[0];\n        }\n        if (!this.supportsTouch) {\n            document.addEventListener(\"mouseup\", this.mouseUp, { passive: true });\n            document.addEventListener(\"mousemove\", this.mouseMove, { passive: true });\n        }\n        else {\n            // Needed only on mobile\n            this.startX = touch.pageX;\n            this.startY = touch.pageY;\n        }\n        if (this.supportsTouch && event instanceof TouchEvent) {\n            this._prevDragX = touch.pageX;\n            this._prevDragY = touch.pageY;\n        }\n        if (event instanceof MouseEvent) {\n            this._prevDragX = event.x;\n            this._prevDragY = event.y;\n        }\n        this._canScroll = this._isTouchInside(event);\n    }\n    ontouchmove(event) {\n        if (!this._canScroll) {\n            return;\n        }\n        const container = this._container;\n        const touch = this.supportsTouch ? event.touches[0] : null;\n        const dragX = this.supportsTouch ? touch.pageX : event.x;\n        const dragY = this.supportsTouch ? touch.pageY : event.y;\n        container.scrollLeft += this._prevDragX - dragX;\n        container.scrollTop += this._prevDragY - dragY;\n        this.fireEvent(scrollEventName, {\n            isLeft: dragX > this._prevDragX,\n            isRight: dragX < this._prevDragX,\n        });\n        this.cachedValue.dragX = this._prevDragX;\n        this.cachedValue.dragY = this._prevDragY;\n        this._prevDragX = dragX;\n        this._prevDragY = dragY;\n    }\n    ontouchend(event) {\n        if (this.supportsTouch) {\n            const deltaX = Math.abs(event.changedTouches[0].pageX - this.startX);\n            const deltaY = Math.abs(event.changedTouches[0].pageY - this.startY);\n            if (deltaX < 10 && deltaY < 10) {\n                return;\n            }\n        }\n        if (!this._canScroll) {\n            return;\n        }\n        const container = this._container;\n        const dragX = this.supportsTouch ? event.changedTouches[0].pageX : event.x;\n        const dragY = this.supportsTouch ? event.changedTouches[0].pageY : event.y;\n        container.scrollLeft += this._prevDragX - dragX;\n        container.scrollTop += this._prevDragY - dragY;\n        const useCachedValues = dragX === this._prevDragX;\n        const _dragX = useCachedValues ? this.cachedValue.dragX : dragX;\n        // const _dragY = useCachedValues ? this.cachedValue.dragY : dragY; add if needed\n        this.fireEvent(touchEndEventName, {\n            isLeft: _dragX < this._prevDragX,\n            isRight: _dragX > this._prevDragX,\n        });\n        this._prevDragX = dragX;\n        this._prevDragY = dragY;\n        if (!this.supportsTouch) {\n            document.removeEventListener(\"mousemove\", this.mouseMove);\n            document.removeEventListener(\"mouseup\", this.mouseUp);\n        }\n    }\n}\nexport default ScrollEnablement;\n//# sourceMappingURL=ScrollEnablement.js.map"],"names":["scroll","element","dx","dy","scrollLeft","scrollTop","animate","duration","progress","scrollEventName","touchEndEventName","supportsTouch","ScrollEnablement","EventProvider","containerComponent","container","left","top","retryCount","retryInterval","containerPainted","resolve","disableAnimation","event","touch","rect","x","y","dragX","dragY","deltaX","deltaY","_dragX"],"mappings":"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","x_google_ignoreList":[0,1]}