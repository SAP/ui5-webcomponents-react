const o=new WeakMap,r=new WeakMap,m={attributes:!0,childList:!0,characterData:!0,subtree:!0},g=t=>{const e=t;return e.accessibleNameRef?k(t):e.accessibleName?e.accessibleName:void 0},k=t=>{var s;const e=((s=t.accessibleNameRef)==null?void 0:s.split(" "))??[],c=t.getRootNode();let a="";return e.forEach((l,h)=>{const n=c.querySelector(`[id='${l}']`),b=`${n&&n.textContent?n.textContent:""}`;b&&(a+=b,h<e.length-1&&(a+=" "))}),a},d=t=>{var c;const e=new Set;return f(t).forEach(a=>{e.add(a)}),(((c=t.accessibleNameRef)==null?void 0:c.split(" "))??[]).forEach(a=>{const s=v(t,a);s&&e.add(s)}),Array.from(e)},f=t=>{const e=t.getRootNode().querySelectorAll(`[for="${t.id}"]`);return Array.from(e)},v=(t,e)=>t.getRootNode().querySelector(`[id='${e}']`),p=t=>{const e=[];if(f(t).forEach(c=>{const a=c.textContent;a&&e.push(a)}),e.length)return e.join(" ")},E=t=>e=>{if(!(e&&e.type==="property"&&e.name==="accessibleNameRef"))return;const c=r.get(t);if(!c)return;const a=c.observedElements,s=d(t);a.forEach(l=>{s.includes(l)||i(c,l)}),s.forEach(l=>{a.includes(l)||(u(c,l),c.observedElements.push(l))}),c==null||c.callback()},N=(t,e)=>{if(r.has(t))return;const c=d(t),a=E(t),s={host:t,observedElements:c,callback:e,invalidationCallback:a};r.set(t,s),t.attachInvalidate(a),c.forEach(l=>{u(s,l)}),e()},u=(t,e)=>{let c=o.get(e);if(!c){c={observer:null,callbacks:[]};const a=new MutationObserver(()=>{c.callbacks.forEach(l=>{l()});const s=document.getElementById(e.id);t.host.id===e.getAttribute("for")||s||i(t,e)});c.observer=a,a.observe(e,m),o.set(e,c)}c.callbacks.includes(t.callback)||c.callbacks.push(t.callback)},i=(t,e)=>{var a;const c=o.get(e);c&&(c.callbacks=c.callbacks.filter(s=>s!==t.callback),c.callbacks.length||((a=c.observer)==null||a.disconnect(),o.delete(e))),t.observedElements=t.observedElements.filter(s=>s!==e)},y=t=>{const e=r.get(t);e&&([...e.observedElements].forEach(c=>{i(e,c)}),t.detachInvalidate(e.invalidationCallback),r.delete(t))};export{N as A,p as M,y as T,k as b,g as v};
